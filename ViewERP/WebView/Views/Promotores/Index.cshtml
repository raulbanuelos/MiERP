
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    #chart_div .google-visualization-orgchart-linebottom {
        border-bottom: 4px solid #0ea156;
    }

    #chart_div .google-visualization-orgchart-lineleft {
        border-left: 4px solid #0ea156;
    }

    #chart_div .google-visualization-orgchart-lineright {
        border-right: 4px solid #0ea156;
    }

    #chart_div .google-visualization-orgchart-linetop {
        border-top: 4px solid #0ea156;
    }
</style>

<a href="@Url.Action("Create", "Promotores")">Nuevo promotor</a>


 <div id="chart_div"></div>


<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
    google.charts.load('current', { packages: ["orgchart"] });
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Name');
        data.addColumn('string', 'Manager');
        data.addColumn('string', 'ToolTip');
        
       
        
        var urlSave = '@Url.Action("GetAllPromotores", "Promotores")';
        $.ajax({
            type: "POST",
            url: urlSave,
            data: JSON.stringify({ parametro: "" }),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (informacion) {
               
                var idGerente = '' + informacion.Yo.idUsuario;
                var nombreGerente = informacion.Yo.Nombre;
                
                data.addRow([{ v: idGerente, f: nombreGerente + '<div style="color:tomato; font-style:italic">Gerente</div>' }, '', 'Gerente']);
                
                $.each(informacion.Promotores, function (index, item) {
                    data.addRow([{ v: item.Nombre, f: '<div><a href="@Url.Action("Editar","Promotores")?id=' + item.idUsuario + '">' + item.Nombre + '</a></div> <div style="color:tomato; font-style:italic">Promotor</div> '}, idGerente, item.Nombre]);
                });

            },
            error: function (result) {
                alert("Woops, se produjo un error");
            },
            complete: function (d) {
                var chart = new google.visualization.OrgChart(document.getElementById('chart_div'));
                
                chart.draw(data, { 'allowHtml': true, 'allowCollapse': true, 'size': 'large', color: '#000000', selectionColor: '#bcab31' });
            }
        });

    }
</script>